paths:
  /admin/upload:
    post:
      tags: [Upload - Admin]
      summary: Upload single or multiple files to ImageKit
      description: |
        Unified upload endpoint supporting both single and multiple file uploads with:
        - Single file upload using 'file' field
        - Multiple file upload using 'files[]' field
        - Preserving existing URLs with 'existing' parameter
        - Deleting specified files with 'deletes' parameter
        - Optional folder organization

        Requires media.create permission. Matches Next.js upload utility pattern.
      security:
        - bearerAuth: []
      requestBody:
        required: false
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: Single file to upload (use this OR files[])
                files[]:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Array of files to upload (use this OR file)
                folder:
                  type: string
                  description:
                    Folder path in ImageKit where files will be uploaded. If browsing '/gallery',
                    set this to '/gallery' to upload files there.
                  example: '/gallery'
                existing:
                  type: string
                  description:
                    JSON array of existing URLs to preserve (sent as string from FormData)
                  example: '["https://ik.imagekit.io/po5udmmiz/uploads/image1.jpg"]'
                deletes:
                  type: string
                  description: JSON array of URLs to delete (sent as string from FormData)
                  example: '["https://ik.imagekit.io/po5udmmiz/uploads/old.jpg"]'
      responses:
        '201':
          description: Files uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  urls:
                    type: array
                    items:
                      type: string
                    description: Combined array of existing + newly uploaded URLs
                  uploaded:
                    type: integer
                    description: Number of files uploaded
                  deleted:
                    type: integer
                    description: Number of files deleted
                required: [success, urls, uploaded, deleted]
              examples:
                singleFile:
                  summary: Single file upload
                  value:
                    success: true
                    urls:
                      - 'https://ik.imagekit.io/po5udmmiz/uploads/banner.jpg'
                    uploaded: 1
                    deleted: 0
                multipleFiles:
                  summary: Multiple files with existing and deletes
                  value:
                    success: true
                    urls:
                      - 'https://ik.imagekit.io/po5udmmiz/uploads/existing.jpg'
                      - 'https://ik.imagekit.io/po5udmmiz/uploads/new1.jpg'
                      - 'https://ik.imagekit.io/po5udmmiz/uploads/new2.jpg'
                    uploaded: 2
                    deleted: 1
        '400':
          description: Bad request - no files provided
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  code:
                    type: string
              example:
                success: false
                message: 'At least one file is required'
                code: 'FILE_REQUIRED'
        '401': { description: Unauthorized }
        '403': { description: Forbidden }
