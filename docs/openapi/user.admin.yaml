paths:
  /admin/user/admins:
    get:
      tags: [Admin Users - Admin]
      summary: List admin users
      description: List all admin/staff users (not customers, merchants, vendors, etc.)
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: page
          schema: { type: integer, minimum: 1 }
        - in: query
          name: perPage
          schema: { type: integer, minimum: 1, maximum: 100 }
        - in: query
          name: q
          schema: { type: string }
          description: Search by name or email
        - in: query
          name: isActive
          schema: { type: boolean }
          description: Filter by active status
        - in: query
          name: isAdmin
          schema: { type: boolean }
          description: Filter by admin status
        - in: query
          name: roleId
          schema: { type: string }
          description: Filter by role ID
      responses:
        '200': { description: Admin users fetched }
    post:
      tags: [Admin Users - Admin]
      summary: Create admin user
      description: |
        Create a new admin/staff user. Only users with isAdmin=true can be assigned roles.
        Regular users (isAdmin=false) will not have roles assigned even if roleIds is provided.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, email, password]
              properties:
                name:
                  type: string
                  example: John Doe
                email:
                  type: string
                  format: email
                  example: john@example.com
                password:
                  type: string
                  format: password
                  example: SecurePass123
                isActive:
                  type: boolean
                  default: true
                isAdmin:
                  type: boolean
                  default: false
                  description: Only admin users (isAdmin=true) can be assigned roles
                roleIds:
                  type: array
                  items:
                    type: string
                  description: Array of role IDs to assign (only applied if isAdmin=true)
                  example: ['role-uuid-1', 'role-uuid-2']
      responses:
        '200':
          description: Admin user created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminUserResponse'
        '409': { description: Email already exists }
        '422': { description: Validation error }
  /admin/user/admins/{id}:
    get:
      tags: [Admin Users - Admin]
      summary: Get admin user by ID
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Admin user fetched }
        '404': { description: Not found }
    put:
      tags: [Admin Users - Admin]
      summary: Update admin user
      description: |
        Update admin user. Roles can only be assigned/updated if user is/will be admin (isAdmin=true).
        If user is demoted from admin (isAdmin=false), all roles will be automatically removed.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                email: { type: string, format: email }
                password:
                  type: string
                  format: password
                  description: Leave empty to keep current password
                isActive: { type: boolean }
                isAdmin:
                  type: boolean
                  description: If set to false, all assigned roles will be removed
                roleIds:
                  type: array
                  items:
                    type: string
                  description:
                    Array of role IDs to assign (replaces existing roles, only applied if
                    isAdmin=true)
                  example: ['role-uuid-1', 'role-uuid-2']
      responses:
        '200':
          description: Admin user updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminUserResponse'
        '404': { description: Not found }
        '409': { description: Email already exists }
    delete:
      tags: [Admin Users - Admin]
      summary: Delete admin user
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Admin user deleted }
        '404': { description: Not found }
  /admin/user/admins/{id}/toggle-status:
    patch:
      tags: [Admin Users - Admin]
      summary: Toggle admin user active status
      description: Activate or deactivate an admin user account
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Admin user status toggled }
        '404': { description: Not found }
  /admin/user/admins/{id}/assign-role:
    post:
      tags: [Admin Users - Admin]
      summary: Assign multiple roles to admin user
      description: |
        Assign one or more roles to an admin user. This replaces all existing role assignments.
        User must have isAdmin=true to receive role assignments.
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [roleIds]
              properties:
                roleIds:
                  type: array
                  items:
                    type: string
                  description: Array of role IDs to assign (replaces all existing roles)
                  example: ['role-uuid-1', 'role-uuid-2']
      responses:
        '200':
          description: Roles assigned successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminUserResponse'
        '404': { description: Admin user or role not found }
        '422': { description: roleIds array is required }

components:
  schemas:
    AdminUserResponse:
      type: object
      properties:
        id: { type: string }
        name: { type: string }
        email: { type: string, format: email }
        avatar: { type: string, nullable: true }
        isActive: { type: boolean }
        isAdmin: { type: boolean }
        roles:
          type: array
          description: Array of assigned roles (only for isAdmin=true users)
          items:
            type: object
            properties:
              id: { type: string }
              name: { type: string }
              permissions:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string }
                    name: { type: string }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
      example:
        id: 'user-uuid-123'
        name: 'John Doe'
        email: 'john@example.com'
        avatar: 'https://example.com/avatar.jpg'
        isActive: true
        isAdmin: true
        roles:
          - id: 'role-uuid-1'
            name: 'admin'
            permissions:
              - id: 'perm-uuid-1'
                name: 'admin.read'
              - id: 'perm-uuid-2'
                name: 'admin.create'
          - id: 'role-uuid-2'
            name: 'editor'
            permissions:
              - id: 'perm-uuid-3'
                name: 'post.read'
              - id: 'perm-uuid-4'
                name: 'post.create'
        createdAt: '2025-10-31T10:00:00Z'
        updatedAt: '2025-10-31T10:00:00Z'
